SELECT count(*)  INTO @total_count FROM tweets tc ;
SELECT  raw.bin, raw.num, TO_PERCENT(raw.num/@total_count) AS bin_pct, SUM(running.num) AS running_total, TO_PERCENT(SUM(running.num)/@total_count) AS running_pct
FROM    ( SELECT length(fromsource) 	as bin, count(*) as num FROM tweets t GROUP BY bin ) raw,
        ( SELECT length(fromsource) as bin, count(*) as num FROM tweets t GROUP BY bin ) running WHERE running.bin <= raw.bin GROUP BY raw.bin
        ;


-- +-----+---------+----------+---------------+-------------+
-- | bin | num     | bin_pct  | running_total | running_pct |
-- +-----+---------+----------+---------------+-------------+
-- |   0 |     487 |   0.0297 |           487 |      0.0297 |
-- |   2 |   12313 |   0.7502 |         12800 |      0.7799 |
-- |   3 | 3570847 | 217.5615 |       3583647 |    218.3413 |
-- |   4 |   44367 |   2.7032 |       3628014 |    221.0445 |
-- |   5 |   84546 |   5.1511 |       3712560 |    226.1956 |
-- |   6 |  381814 |  23.2628 |       4094374 |    249.4585 |
-- |   7 |  260068 |  15.8452 |       4354442 |    265.3036 |
-- |   8 |   71739 |   4.3709 |       4426181 |    269.6745 |
-- |   9 |  278073 |  16.9422 |       4704254 |    286.6167 |
-- |  10 |  543197 |  33.0954 |       5247451 |    319.7121 |
-- |  11 |  385915 |  23.5127 |       5633366 |    343.2248 |
-- |  12 |  535769 |  32.6429 |       6169135 |    375.8677 |
-- |  13 |   38166 |   2.3253 |       6207301 |    378.1930 |
-- |  14 |   28505 |   1.7367 |       6235806 |    379.9298 |
-- |  15 |    2433 |   0.1482 |       6238239 |    380.0780 |
-- |  16 |     594 |   0.0362 |       6238833 |    380.1142 |
-- |  17 |   14463 |   0.8812 |       6253296 |    380.9954 |
-- |  18 |     264 |   0.0161 |       6253560 |    381.0115 |
-- |  19 |     661 |   0.0403 |       6254221 |    381.0517 |
-- |  20 |    4590 |   0.2797 |       6258811 |    381.3314 |
-- |  21 |      81 |   0.0049 |       6258892 |    381.3363 |
-- |  22 |      93 |   0.0057 |       6258985 |    381.3420 |
-- |  23 |     976 |   0.0595 |       6259961 |    381.4014 |
-- |  24 |      20 |   0.0012 |       6259981 |    381.4027 |
-- |  25 |      29 |   0.0018 |       6260010 |    381.4044 |
-- |  26 |     219 |   0.0133 |       6260229 |    381.4178 |
-- |  31 |       2 |   0.0001 |       6260231 |    381.4179 |
-- |  35 |      14 |   0.0009 |       6260245 |    381.4188 |
-- |  50 |     929 |   0.0566 |       6261174 |    381.4754 |
-- +-----+---------+----------+---------------+-------------+
-- 29 rows in set (13.14 sec)

SELECT  raw.bin, raw.num, TO_PERCENT(raw.num/@total_count) AS bin_pct, SUM(running.num) AS running_total, TO_PERCENT(SUM(running.num)/@total_count) AS running_pct
FROM    ( SELECT length(fromsource_url) as bin, count(*) as num FROM tweets t GROUP BY bin ) raw,
        ( SELECT length(fromsource_url) as bin, count(*) as num FROM tweets t GROUP BY bin ) running WHERE running.bin <= raw.bin GROUP BY raw.bin
        ;

+-----+---------+---------+---------------+-------------+
| bin | num     | bin_pct | running_total | running_pct |
+-----+---------+---------+---------------+-------------+
|   0 | 3244536 | 51.8199 |       3244536 |     51.8199 |
|   3 |     207 |  0.0033 |       3244743 |     51.8232 |
..
|  11 |      28 |  0.0004 |       3244924 |     51.8261 |
|  12 |    1284 |  0.0205 |       3246208 |     51.8466 |
|  13 |      50 |  0.0008 |       3246258 |     51.8474 |
|  14 |   15522 |  0.2479 |       3261780 |     52.0953 |
|  15 |     658 |  0.0105 |       3262438 |     52.1058 |
|  16 |    7200 |  0.1150 |       3269638 |     52.2208 |
|  17 |   21793 |  0.3481 |       3291431 |     52.5689 |
|  18 |   14487 |  0.2314 |       3305918 |     52.8003 |
|  19 |  106385 |  1.6991 |       3412303 |     54.4994 |
|  20 |   15458 |  0.2469 |       3427761 |     54.7463 |
|  21 |   25752 |  0.4113 |       3453513 |     55.1576 |
|  22 |  704015 | 11.2441 |       4157528 |     66.4017 |
|  23 |   25760 |  0.4114 |       4183288 |     66.8132 |
|  24 |   18487 |  0.2953 |       4201775 |     67.1084 |
|  25 |  265757 |  4.2445 |       4467532 |     71.3529 |
|  26 |    3381 |  0.0540 |       4470913 |     71.4069 |
|  27 |   29302 |  0.4680 |       4500215 |     71.8749 |
|  28 |   30919 |  0.4938 |       4531134 |     72.3688 |
|  29 |    2422 |  0.0387 |       4533556 |     72.4074 |
|  30 |   91491 |  1.4612 |       4625047 |     73.8687 |
..
|  38 |   27980 |  0.4469 |       4696186 |     75.0049 |
|  39 |   29060 |  0.4641 |       4725246 |     75.4690 |
|  40 |  363299 |  5.8024 |       5088545 |     81.2714 |
|  41 |   29348 |  0.4687 |       5117893 |     81.7401 |
|  42 |    2414 |  0.0386 |       5120307 |     81.7787 |
|  43 |   41403 |  0.6613 |       5161710 |     82.4400 |
|  44 |  515510 |  8.2334 |       5677220 |     90.6734 |
...
|  50 |  340610 |  5.4400 |       6019821 |     96.1452 |
|  51 |    2369 |  0.0378 |       6022190 |     96.1831 |
|  52 |   28702 |  0.4584 |       6050892 |     96.6415 |
...
|  62 |     264 |  0.0042 |       6054696 |     96.7022 |
|  63 |   32295 |  0.5158 |       6086991 |     97.2180 |
|  64 |       7 |  0.0001 |       6086998 |     97.2182 |
|  65 |    5149 |  0.0822 |       6092147 |     97.3004 |
|  66 |    1189 |  0.0190 |       6093336 |     97.3194 |
...
|  79 |  167092 |  2.6687 |       6260971 |     99.9968 |
|  84 |      70 |  0.0011 |       6261041 |     99.9979 |
|  86 |      14 |  0.0002 |       6261055 |     99.9981 |
|  87 |      70 |  0.0011 |       6261125 |     99.9992 |
|  95 |      49 |  0.0008 |       6261174 |    100.0000 |
+-----+---------+---------+---------------+-------------+
78 rows in set, 21 warnings (43.40 sec)

--
-- Most popular sources
-- 
SELECT fromsource as bin, fromsource_url, count(*) as num 
FROM tweets t 
GROUP BY bin 
ORDER BY num DESC
LIMIT 50



